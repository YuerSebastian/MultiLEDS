setwd("D:/Cosa/R")
setwd("D:/Cosa/R")
setwd("D:/Cosa/R")
library(dplyr);library(lubridate);library(tidyr);library(googlesheets4);library(readr);library(readxl)
#Variables principales.
c <- list.dirs("D:/Trabajo")
c <- c(c,"1BrBMTo2j14lTF-Cn9DP6rWtYJFxLW5OlYhWsvnahEJ0") #Se añade al último solo si se requiere una sheet de google
desc <- list.files(c[grep("FLOKZU$",c)],full.names = T)
gs4_auth(email = "jsalinba@utel.edu.mx")#Iniciando google
#Funciones
leer_arch <- function(c,tipo="csv",arch=NULL,pat=NULL,...){
#Resume la lectura que se usa siempre para los reportes, se pueden usar opciones adicionales de las funciones internas.
if (tipo=="csv") {
x <- read_csv(paste(c[grep(pat,c)],paste(arch,tipo,sep = "."),sep = "/"),locale = locale(encoding = "LATIN1"),col_types = cols(.default = "c"),...)
}else if (tipo=="xlsx"){
x <- read_excel(paste(c[grep(pat,c)],paste(arch,tipo,sep = "."),sep = "/"),col_types = "text",...)
}else if (tipo=="txt"){
x <- read_delim(paste(c[grep(pat,c)],paste(arch,tipo,sep = "."),sep = "/"),locale = locale(encoding = "LATIN1"),col_types = cols(.default = "c"),...)
}else if (tipo=="gsheet"){
x <- range_speedread(c[length(c)],col_types = cols(.default = "c"),...)
}else{x <- "Tipo incorrecto."}
return(x)
}
impr_arch <- function(c,x,tipo="csv",arch=NULL,pat=NULL,...){
write.csv(x,paste(c[grep(pat,c)],paste(arch,tipo,sep="."),sep="/"),row.names = F,...)
}
for (i in 1:length(desc)) {
Rep <- read_excel(desc[i],skip=1,col_types="text") %>% reshape::rename(c(`Fecha asignación Tarea actual`="Fecha Tarea",`A.analista SER`="Analista SER",
`Correo del estudiante`="Correo",`Correo del prospecto`="Correo"))
if (length(rownames(Rep))!=0) {
if(!hasName(Rep,"Matricula")) Rep <- rename(Rep,"Matricula"=SIU); if(!hasName(Rep,"Correo")) Rep <- mutate(Rep,Correo="_")
Rep <- select(Rep,Identificador,"Matrícula"=Matricula,Correo,`Fecha Inicio`,Finalizado,`Fecha Finalización`,`Tarea Actual`,`Fecha Tarea`,`Analista SER`)
if(exists("Base")) Base <- rbind(Base,Rep) else Base <- Rep
}
}
View(Base)
View(Base)
Base <- mutate(Base,Proceso=gsub("-[0-9]+","",Identificador)) %>% mutate_all(~stringi::stri_trim(.)) %>% mutate_all(~gsub("\n","",.)) %>% filter(!duplicated(Identificador))%>%
mutate(`Analista SER`= gsub("Francisco Javier Sandoval Cevantes","Francisco Javier Sandoval Cervantes",`Analista SER`),#Nombres erroneos
`Analista SER`= gsub("Jocelyn Velarde Hernandez","Jocelyn Velarde Hernández",`Analista SER`))
View(Base)
Rep <- leer_arch(c,"csv","Tickets Resúmen","auxiliares$", lazy = F,
col_select = c("Identificador","Responsable","Responsable Apoyo","EstadoA"=Estado,"Fecha Asignación","FFRA"=`Fecha Fin Real`))
t_a <- length(rownames(Rep))#Tamaño de la base anterior
Base <- left_join(Base,Rep,by = "Identificador") %>% mutate(`Fecha Asignación`=if_else(is.na(`Fecha Asignación`),as.character(now()),`Fecha Asignación`),
nuevo=if_else(is.na(Responsable),if_else(grepl("SER]|SERVICIOS|ARCHIVO]",`Tarea Actual`),"N","x"),"_"))%>%
filter(nuevo!="x") %>% mutate_at(c(grep("^Fecha|FFRA",names(Base))),~if_else(nchar(.)==16,paste(.,":02",sep=""),.))#Fechas con 0 segundos
setwd("D:/Cosa/R")
setwd("D:/Scripts/R/InicioGeneral")
setwd("D:/Cosa/R")
setwd("D:/Cosa/R")
load("D:/Scripts/R/Cosas.RData")
setwd("D:/Scripts/R/InicioGeneral")
setwd("D:/Cosa/R")
setwd("D:/Cosa/R")
setwd("D:/Cosa/R")
setwd("D:/Scripts/R/InicioGeneral")
setwd("D:/Scripts/R/InicioGeneral")
setwd("D:/Cosa/R")
setwd("D:/Cosa/R")
setwd("D:/Cosa/R")
library(dplyr);library(lubridate);library(tidyr);library(googlesheets4);library(readr);library(readxl)
#Variables principales.
c <- list.dirs("D:/Trabajo")
c <- c(c,"1BrBMTo2j14lTF-Cn9DP6rWtYJFxLW5OlYhWsvnahEJ0") #Se añade al último solo si se requiere una sheet de google
desc <- list.files(c[grep("FLOKZU$",c)],full.names = T)
gs4_auth(email = "jsalinba@utel.edu.mx")#Iniciando google
#Funciones
leer_arch <- function(c,tipo="csv",arch=NULL,pat=NULL,...){
#Resume la lectura que se usa siempre para los reportes, se pueden usar opciones adicionales de las funciones internas.
if (tipo=="csv") {
x <- read_csv(paste(c[grep(pat,c)],paste(arch,tipo,sep = "."),sep = "/"),locale = locale(encoding = "LATIN1"),col_types = cols(.default = "c"),...)
}else if (tipo=="xlsx"){
x <- read_excel(paste(c[grep(pat,c)],paste(arch,tipo,sep = "."),sep = "/"),col_types = "text",...)
}else if (tipo=="txt"){
x <- read_delim(paste(c[grep(pat,c)],paste(arch,tipo,sep = "."),sep = "/"),locale = locale(encoding = "LATIN1"),col_types = cols(.default = "c"),...)
}else if (tipo=="gsheet"){
x <- range_speedread(c[length(c)],col_types = cols(.default = "c"),...)
}else{x <- "Tipo incorrecto."}
return(x)
}
impr_arch <- function(c,x,tipo="csv",arch=NULL,pat=NULL,...){
write.csv(x,paste(c[grep(pat,c)],paste(arch,tipo,sep="."),sep="/"),row.names = F,...)
}
for (i in 1:length(desc)) {
Rep <- read_excel(desc[i],skip=1,col_types="text") %>% reshape::rename(c(`Fecha asignación Tarea actual`="Fecha Tarea",`A.analista SER`="Analista SER",
`Correo del estudiante`="Correo",`Correo del prospecto`="Correo"))
if (length(rownames(Rep))!=0) {
if(!hasName(Rep,"Matricula")) Rep <- rename(Rep,"Matricula"=SIU); if(!hasName(Rep,"Correo")) Rep <- mutate(Rep,Correo="_")
Rep <- select(Rep,Identificador,"Matrícula"=Matricula,Correo,`Fecha Inicio`,Finalizado,`Fecha Finalización`,`Tarea Actual`,`Fecha Tarea`,`Analista SER`)
if(exists("Base")) Base <- rbind(Base,Rep) else Base <- Rep
}
}
View(Base)
.x <- ""
cosa <- function(x){
.x <- x
}
.x <- ""
cosa <- function(x){
.x <- x
}
cosa("hola")
.x
globalVariables(c(".x"))
.Call(.x)
library(googledrive); library(googlesheets4)
View(rlang_downstream_check)
force(gs4_auth)
View(gs4_auth)
View(`%>%`)
View(as_sheets_id)
force(gs4_token)
View(gs4_token)
force(gs4_auth_configure)
View(gs4_auth_configure)
View(request_generate)
cosa <- function(x){
.algo <- x
}
cosa("c")
.algo
globalVariables(".algo")
cosa("c")
.algo
.Call(.algo)
.Call(".algo")
globalVariables()
.Call(.algo,1)
globalVariables()
globalVariables()
email <<- ""
cosa <- function(x){
email <- x
}
email
email
email <<- ""
cosa <- function(x){
email <<- x
}
email
email <<- ""
cosa <- function(x){
email <- x
}
cosa("cosa")
email
email
email
email
email <<- ""
cosa <- function(x){
email <<- x
}
cosa("cosa")
email
cosa <- function(x){
email <<- x
}
cosa("cosa")
cosa("caso")
caso
hola <- "d"
hola
email
remove.packages("InfoGeneral")
remove.packages(InfoGeneral)
remove.packages("InicioGeneral")
remove.packages("InicioGeneral")
remove.packages("InicioGeneral")
remove.packages("InicioGeneral")
dir_y_drive <- function(c,email){
.c <<- c
.email <<- email
}
dir_y_drive <- function(c=NULL,email=NULL){
.c <<- c
.email <<- email
}
dir_y_drive("cosa","algo")
dir_y_drive <- function(c=NULL,email=NULL){
.c <<- c
.email <<- email
}
dir_y_drive("cosa","algo")
.email
.cosa
.c
library(MultiLEDS)
library(MultiLEDS)
packageVersion("dplyr")
packageVersion("tidyr")
packageVersion("readr")
packageVersion("googledrive")
packageVersion("googlesheets4")
packageVersion("readxl")
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
dir_y_drive <- function(c=NULL,email=NULL){
.c <<- c
if (!is.null(email)){
.email <<- email
googledrive::drive_auth(.email)
googlesheets4::gs4_auth(.email)
}
}
leer(c("Historico_Decisiones","Escolares"))
leer(c("Historico_Decisiones","Escolares"))
library(dplyr);library(lubridate);library(tidyr);library(readr); library(googledrive); library(googlesheets4); library(readxl)
leer(c("Historico_Decisiones","Escolares"))
dir_y_drive <- function(c=NULL,email=NULL){
assign(".c",c)
if (!is.null(email)){
assign(".email",email)
googledrive::drive_auth(.email)
googlesheets4::gs4_auth(.email)
}
}
dir_y_drive("D:/Trabajo","jsalinba@utel.edu.mx")
leer(c("Historico_Decisiones","Escolares"))
dir_y_drive <- function(c=NULL,email=NULL){
.c <<- list.dirs(c)
if (!is.null(email)){
.email <<- email
googledrive::drive_auth(.email)
googlesheets4::gs4_auth(.email)
}
}
dir_y_drive("D:/Trabajo","jsalinba@utel.edu.mx")
leer(c("Historico_Decisiones","Escolares"))
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(dplyr);library(lubridate);library(tidyr);library(readr); library(googledrive); library(googlesheets4); library(readxl)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
diremail <- function(c="",email=""){
if(c != "") .c <<- list.dirs(c) else .c <- ""
.email <<- email
if (.email != ""){
googledrive::drive_auth(.email)
googlesheets4::gs4_auth(.email)
}
}
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
setwd("D:/Scripts/R")
cosa <- "cosa1","cosa1","cosa2","cosa10","cosa3","cosa4"
cosa <- c("cosa1","cosa1","cosa2","cosa10","cosa3","cosa4")
cosa <- cosa[grep("1",cosa)]
cosa
library(MultiLEDS)
diremail("D:/Trabajo","jsalinba@utel.edu.mx")
Base <- unificar("Escolares$","Actas Docente")
Base <- unificar("Escolares$","MATRICULA")
Base <- unificar("Escolares$",cols="MATRICULA")
Base <- unificar("Escolares$",patron = "Actas Docente",cols="MATRICULA")
cosa <- list.files("D:/Trabajo/Bases/Originales/SIR/Servicios Escolares")
cosa
pat <- "Actas Docente"
cosa <- list.files("D:/Trabajo/Bases/Originales/SIR/Servicios Escolares",full.names = T)
cosa <- cosa[grep(pat,cosa)]
cosa
library(MultiLEDS)
diremail("D:/Trabajo","jsalinba@utel.edu.mx")
Base <- unificar("Escolares$","Actas Docente","MATRICULA")
View(Base)
Base <- unificar("Escolares$","Actas Docente")
View(Base)
Base <- unificar("Escolares$","Actas Docente")
View(Base)
library(MultiLEDS)
diremail("D:/Trabajo","jsalinba@utel.edu.mx")
Base <- unificar("Escolares$","Actas Docente",col_select=c("MATRICULA"))
Base <- unificar("Escolares$",pat = NULL,cols = NULL,renom = NULL,col_select=c("MATRICULA"))
Base <- unificar("Escolares$","Actas Docente")
library(MultiLEDS)
diremail("D:/Trabajo","jsalinba@utel.edu.mx")
Base <- unificar("Escolares$","Actas Docente")
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
library(MultiLEDS)
